# このディレクトリについて

サービス層
レポジトリ層から得たデータをハンドラ層が欲しい形に加工する

## 役割

<!-- 以下の２を埋める役割

### GET /article/{id}のハンドラ- ArticleDetailHandler の場合

1. パスから、取得した記事の ID を得る
2. 指定 ID の記事をデータベースから取得する
3. 結果をレスポンスに書きこむ

### POST /article/nice のハンドラ- PostNiceHandler の場合

1. リクエストボディから、いいねを付けたい記事を判断
2. 指定記事にいいねを+1 する更新作業をデータベースに保存する
3. 結果をレスポンスに書き込む

### POST /comment のハンドラ- PostCommentHandler の場合

1. リクエストボディから投稿したいコメント内容を取得する
2. 1 の内容をデータベースに挿入して、実際にデータベース内に収められた値を得る
3. 結果をレスポンスに書き込む -->

サービス層に必要な機能をまとめ

- ArticleDetailHandler: 指定 ID の記事をデータベースから取得する
- PostArticleHandler: 記事データをデータベース内に挿入し、その値を返す
- ArticleListHandler: クエリパラメータで指定されたページの記事一覧をデータベース
  から取得する
- PostNiceHandler: 指定記事にいいねを+1 する更新作業をデータベースに保存し、その
  結果を返す
- PostCommentHandler: コメントデータをデータベース内に挿入し、その値を返す

## テスト

# サービス層の役割

サービス層として本当に関心があるのは「ハンドラ層用のデータに整形する」という部分であり、本質的ではない外部要因データベースによって挙動が左右されてしまうというのは混乱を招く仕様でしょう。そのため、サービス層の中にデータベース接続処理を含ませる、つまりサービス層が直接データベース接続処理に依存するという構図は排除するべきです。

## 不都合の例

- データベースを MySQL から PostgresSQL のような別のエンジンのものに変えたら、連鎖的にサービス層も大きな変更を強いられてしまいます。
- データベースとの接続に失敗した場合には、サービス層で本当に実行したい処理「ハンドラ層に渡すようにデータを整形する」という部分に問題がなくてもサービス層でのエラー扱いになります。サービス層として本当
